{% load static %}
<!--datatable css-->
<link rel="stylesheet" href="{% static 'datatables/css/dataTables.bootstrap5.min.css' %}" />
<link rel="stylesheet" href="{% static 'datatables/css/responsive.bootstrap.min.css' %}" />
<link rel="stylesheet" href="{% static 'datatables/css/buttons.dataTables.min.css' %}" />
<!--end datatable css-->
<!--datatable js-->
<script src="{% static 'datatables/js/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'datatables/js/dataTables.bootstrap5.min.js' %}"></script>
<script src="{% static 'datatables/js/dataTables.responsive.min.js' %}"></script>
<script src="{% static 'datatables/js/dataTables.buttons.min.js' %}"></script>
<script src="{% static 'datatables/js/buttons.print.min.js' %}"></script>
<script src="{% static 'datatables/js/buttons.html5.min.js' %}"></script>
<script src="{% static 'datatables/js/vfs_fonts.js' %}"></script>
<script src="{% static 'datatables/js/pdfmake.min.js' %}"></script>
<script src="{% static 'datatables/js/jszip.min.js' %}"></script>

<script src="{% static 'datatables/js/jquery-3.6.0.min.js' %}"></script>

<script>
    $(function () {
        $('#customerTable').DataTable({
            "paging": true,
            "lengthChange": true,
            "lengthMenu": [ [5, 10, 25, 50, -1], [5, 10, 25, 50, "Tout"] ],
            "searching": true,
            "ordering": true,
            "info": true,
            "autoWidth": true,
            "responsive": true,
            language: {
                processing:     "Traitement en cours...",
                search:         "Rechercher&nbsp;:",
                lengthMenu:    "Afficher _MENU_ &eacute;l&eacute;ments",
                info:           "Affichage de _START_ &agrave; _END_ sur _TOTAL_",
                infoEmpty:      "Affichage de 0 &agrave; 0 sur 0",
                infoFiltered:   "(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",
                infoPostFix:    "",
                loadingRecords: "Chargement en cours...",
                zeroRecords:    "Aucun &eacute;l&eacute;ment &agrave; afficher",
                emptyTable:     "Aucune donnée disponible dans le tableau",
                paginate: {
                    first:      "Premier",
                    previous:   "Pr&eacute;c&eacute;dent",
                    next:       "Suivant",
                    last:       "Dernier"
                },
                aria: {
                    sortAscending:  ": activer pour trier la colonne par ordre croissant",
                    sortDescending: ": activer pour trier la colonne par ordre décroissant"
                }
            }
        });
    });
</script>
<!--end datatable js-->

{% if userFiliale %}
    {% for item in data_list %}
        {% if item.sigle_filiale == userFiliale %}
            <tr  id="movie-{{ item.pk }}">
                <td class="text">{% if item.sigle_filiale %} {{ item.sigle_filiale }} {% endif %}</td>
                <td class="text">{% if item.nom_filiale %} {{ item.nom_filiale }} {% endif %}</td>
                <td class="text">{% if item.code_pays %} {{ item.code_pays }} {% endif %}</td>
                <td class="text">{% if item.dg_filiale %} {{ item.dg_filiale }} {% endif %}</td>
                <td class="text">{% if item.adresse_filiale %} {{ item.adresse_filiale }} {% endif %}</td>
                <td class="text">{% if item.ville_filiale %} {{ item.ville_filiale }} {% endif %}</td>
                <td class="text">{% if item.description_filiale %} {{ item.description_filiale }} {% endif %}</td>
                <td class="text">{% if item.tel_filiale %} {{ item.tel_filiale }} {% endif %}</td>
                <td class="text">{% if item.mob_filiale %} {{ item.mob_filiale }} {% endif %}</td>
                <td class="text">{% if item.fax_filiale %} {{ item.fax_filiale }} {% endif %}</td>
                <td class="text">{% if item.email_filiale %} {{ item.email_filiale }} {% endif %}</td>
                <td class="text">{% if item.adresseip_smtp %} {{ item.adresseip_smtp }} {% endif %}</td>
                <td class="text">{% if item.port_smtp %} {{ item.port_smtp }} {% endif %}</td>
                <td class="text">{% if item.j_relances %} {{ item.j_relances }} {% endif %}</td>
                <td class="text">{% if item.j_statistiques %} {{ item.j_statistiques }} {% endif %}</td>
                <td class="text">{% if item.smtp_user %} {{ item.smtp_user }} {% endif %}</td>
                <td class="text">{% if item.smtp_password %} {{ item.smtp_password }} {% endif %}</td>
                <td>
                    <div class="d-flex gap-2">
                        <div class="edit">
                            <button class="btn btn-sm btn-success edit-item-btn" hx-get="{% url 'services:edit_gestions_des_filiales' pk=item.idfiliale %}" hx-target="#edit_data"  data-bs-toggle="modal" data-bs-target="#showModal">Modifier</button>
                        </div>
                    </div>
                </td>
            </tr>
        {% endif %}
    {% endfor %}
{% else %}
    {% for item in data_list %}
        <tr  id="movie-{{ item.pk }}">
            <td class="text">{% if item.sigle_filiale %} {{ item.sigle_filiale }} {% endif %}</td>
            <td class="text">{% if item.nom_filiale %} {{ item.nom_filiale }} {% endif %}</td>
            <td class="text">{% if item.code_pays %} {{ item.code_pays }} {% endif %}</td>
            <td class="text">{% if item.dg_filiale %} {{ item.dg_filiale }} {% endif %}</td>
            <td class="text">{% if item.adresse_filiale %} {{ item.adresse_filiale }} {% endif %}</td>
            <td class="text">{% if item.ville_filiale %} {{ item.ville_filiale }} {% endif %}</td>
            <td class="text">{% if item.description_filiale %} {{ item.description_filiale|truncatewords:10 }} {% endif %}</td>
            <td class="text">{% if item.tel_filiale %} {{ item.tel_filiale }} {% endif %}</td>
            <td class="text">{% if item.mob_filiale %} {{ item.mob_filiale }} {% endif %}</td>
            <td class="text">{% if item.fax_filiale %} {{ item.fax_filiale }} {% endif %}</td>
            <td class="text">{% if item.email_filiale %} {{ item.email_filiale }} {% endif %}</td>
            <td class="text">{% if item.adresseip_smtp %} {{ item.adresseip_smtp }} {% endif %}</td>
            <td class="text">{% if item.port_smtp %} {{ item.port_smtp }} {% endif %}</td>
            <td class="text">{% if item.j_relances %} {{ item.j_relances }} {% endif %}</td>
            <td class="text">{% if item.j_statistiques %} {{ item.j_statistiques }} {% endif %}</td>
            <td class="text">{% if item.smtp_user %} {{ item.smtp_user }} {% endif %}</td>
            <td class="text">{% if item.smtp_password %} {{ item.smtp_password }} {% endif %}</td>
            <td>
                <div class="d-flex gap-2">
                    <div class="edit">
                        <button class="btn btn-sm btn-success edit-item-btn" hx-get="{% url 'services:edit_gestions_des_filiales' pk=item.idfiliale %}" hx-target="#edit_data"  data-bs-toggle="modal" data-bs-target="#showModal">Modifier</button>
                    </div>
                    <div class="remove">
                        <button class="btn btn-sm btn-danger remove-item-btn" hx-get="{% url 'services:del_gestions_des_filiales' pk=item.idfiliale %}" hx-target="#delete_data" data-bs-toggle="modal" data-bs-target="#deleteRecordModal">Supprimer</button>
                    </div>
                </div>
            </td>
        </tr>
    {% endfor %}
{% endif %}
